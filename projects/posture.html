<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Posture Correction System | Masani Santhosh Kumar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Posture Correction System using Arduino Uno, dual MPU6050 sensors and ultrasonic activation for real-time posture monitoring.">

    <link rel="stylesheet" href="../css/style.css">
</head>

<body>

<section class="projects">
    <div class="container">

        <h2>Posture Correction System</h2>

        <!-- Short Intro -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>Project Overview</h3>
            <p>
                A real-time posture monitoring system built using Arduino Uno,
                dual MPU6050 sensors, ultrasonic-based activation,
                LED indicators, buzzer alerts, and OLED display feedback.
            </p>
        </div>

        <!-- STAR FORMAT -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>S â€” Situation</h3>
            <p>
                Poor sitting posture is a common issue among students and professionals.
                Long hours of incorrect posture gradually lead to neck strain,
                lower back pain, and long-term spinal problems.
                Most people are unaware of their posture until pain appears.
            </p>
        </div>

        <div class="project-card" style="margin-bottom:40px;">
            <h3>T â€” Task</h3>
            <p>
                To design a low-cost, power-efficient embedded system that
                continuously monitors posture in real time and alerts the user
                immediately when incorrect posture is detected.
            </p>
        </div>

        <div class="project-card" style="margin-bottom:40px;">
            <h3>A â€” Action</h3>
            <p>
                I developed a hardware system using:
                <br><br>
                â€¢ Arduino Uno as the controller  
                â€¢ Two MPU6050 sensors (Upper body & Lower body monitoring)  
                â€¢ Ultrasonic sensor for smart activation  
                â€¢ 3 LEDs (Green, Yellow, Red) for posture indication  
                â€¢ Buzzer for audible alerts  
                â€¢ OLED display for real-time posture status  
            </p>

            <p>
                The ultrasonic sensor activates the system only when a person
                is detected continuously for 5 seconds to avoid false detection
                and reduce unnecessary power usage.
            </p>

            <p>
                Posture logic:
                <br>
                ðŸŸ¢ Correct posture â†’ Green LED  
                ðŸŸ¡ Slight bend (upper or lower error) â†’ Yellow LED + slow beep  
                ðŸ”´ Severe bad posture â†’ Red LED + faster buzzer pattern  
            </p>
        </div>

        <div class="project-card" style="margin-bottom:40px;">
            <h3>R â€” Result</h3>
            <p>
                The prototype successfully differentiates between correct posture,
                slight deviation, and severe bad posture.
                It provides instant visual and audio feedback,
                encouraging healthy sitting habits.
            </p>
            <p>
                This project demonstrates how embedded systems can be applied
                practically for preventive healthcare and ergonomic improvement.
            </p>
        </div>

        <!-- System Workflow -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>System Workflow</h3>
            <p>
                1. Ultrasonic sensor checks user presence.  
                2. If user detected continuously for 5 seconds â†’ System activates.  
                3. MPU6050 sensors read body tilt angles.  
                4. Arduino compares values with threshold angles.  
                5. LEDs + Buzzer + OLED provide feedback.  
                6. If no user detected for 5 seconds â†’ System turns OFF.  
            </p>
        </div>

        <!-- Components -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>Components Used</h3>
            <p>
                â€¢ Arduino Uno  
                â€¢ 2 Ã— MPU6050 Sensors  
                â€¢ Ultrasonic Sensor (HC-SR04)  
                â€¢ OLED Display (SSD1306)  
                â€¢ 3 LEDs (Red, Yellow, Green)  
                â€¢ 3 Resistors  
                â€¢ Buzzer  
            </p>
        </div>

        <!-- Circuit Diagram -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>Circuit Diagram</h3>
            <img src="../assets/posture-circuit.jpg" 
                 alt="Posture Circuit Diagram" 
                 style="width:100%; border-radius:8px;">
        </div>

        <!-- Hardware Setup -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>Hardware Setup</h3>
            <img src="../assets/posture-hardware.jpg" 
                 alt="Posture Hardware Setup" 
                 style="width:100%; border-radius:8px;">
        </div>

        <!-- Arduino Code Section -->
        <div class="project-card" style="margin-bottom:40px;">
            <h3>Arduino Code</h3>
            <pre style="background:#111827; padding:20px; border-radius:8px; overflow-x:auto; color:#fff;">
#include <Wire.h>
#include <Adafruit_MPU6050.h>
#include <Adafruit_Sensor.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 64
Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, -1);

Adafruit_MPU6050 mpuUpper;
Adafruit_MPU6050 mpuLower;

// LED Pins
#define GREEN_LED 2
#define YELLOW_LED 3
#define RED_LED 4

// Buzzer
#define BUZZER 8

// Ultrasonic
#define TRIG 9
#define ECHO 10

// Angle Thresholds
#define SLIGHT_THRESHOLD 15
#define SEVERE_THRESHOLD 25

// Activation timing
unsigned long detectStartTime = 0;
bool systemActive = false;

// Calibration offsets
float upperOffset = 0;
float lowerOffset = 0;

void beep(int times, int delayTime) {
  for (int i = 0; i < times; i++) {
    digitalWrite(BUZZER, HIGH);
    delay(delayTime);
    digitalWrite(BUZZER, LOW);
    delay(delayTime);
  }
}

long readDistance() {
  digitalWrite(TRIG, LOW);
  delayMicroseconds(2);
  digitalWrite(TRIG, HIGH);
  delayMicroseconds(10);
  digitalWrite(TRIG, LOW);
  long duration = pulseIn(ECHO, HIGH);
  long distance = duration * 0.034 / 2;
  return distance;
}

float getAngle(Adafruit_MPU6050 &mpu, float offset) {
  sensors_event_t a, g, temp;
  mpu.getEvent(&a, &g, &temp);

  float angle = atan2(a.acceleration.y, a.acceleration.z) * 180 / PI;
  return angle - offset;
}

void calibrate() {
  float sumUpper = 0;
  float sumLower = 0;

  for (int i = 0; i < 100; i++) {
    sensors_event_t a1, g1, t1;
    sensors_event_t a2, g2, t2;

    mpuUpper.getEvent(&a1, &g1, &t1);
    mpuLower.getEvent(&a2, &g2, &t2);

    sumUpper += atan2(a1.acceleration.y, a1.acceleration.z) * 180 / PI;
    sumLower += atan2(a2.acceleration.y, a2.acceleration.z) * 180 / PI;

    delay(10);
  }

  upperOffset = sumUpper / 100;
  lowerOffset = sumLower / 100;
}

void setup() {
  Serial.begin(115200);

  pinMode(GREEN_LED, OUTPUT);
  pinMode(YELLOW_LED, OUTPUT);
  pinMode(RED_LED, OUTPUT);
  pinMode(BUZZER, OUTPUT);

  pinMode(TRIG, OUTPUT);
  pinMode(ECHO, INPUT);

  Wire.begin();

  mpuUpper.begin(0x68);
  mpuLower.begin(0x69);

  display.begin(SSD1306_SWITCHCAPVCC, 0x3C);
  display.clearDisplay();
  display.setTextSize(1);
  display.setTextColor(WHITE);

  delay(2000);
  calibrate();

  display.clearDisplay();
  display.setCursor(0, 0);
  display.println("Calibration Done");
  display.display();
  delay(2000);
}

void loop() {

  long distance = readDistance();

  if (distance < 100) {
    if (!systemActive) {
      if (detectStartTime == 0)
        detectStartTime = millis();

      if (millis() - detectStartTime > 5000) {
        systemActive = true;
        beep(3, 100);
      }
    }
  } else {
    detectStartTime = 0;

    if (systemActive) {
      systemActive = false;
      beep(1, 200);
    }
  }

  if (!systemActive) {
    digitalWrite(GREEN_LED, LOW);
    digitalWrite(YELLOW_LED, LOW);
    digitalWrite(RED_LED, LOW);
    return;
  }

  float upperAngle = abs(getAngle(mpuUpper, upperOffset));
  float lowerAngle = abs(getAngle(mpuLower, lowerOffset));

  display.clearDisplay();
  display.setCursor(0, 0);

  Serial.print("Upper: ");
  Serial.print(upperAngle);
  Serial.print(" | Lower: ");
  Serial.println(lowerAngle);

  if (upperAngle < SLIGHT_THRESHOLD && lowerAngle < SLIGHT_THRESHOLD) {

    digitalWrite(GREEN_LED, HIGH);
    digitalWrite(YELLOW_LED, LOW);
    digitalWrite(RED_LED, LOW);

    display.println("Posture: GOOD");
    display.println("Keep it up!");
  }
  else if (upperAngle < SEVERE_THRESHOLD && lowerAngle < SEVERE_THRESHOLD) {

    digitalWrite(GREEN_LED, LOW);
    digitalWrite(YELLOW_LED, HIGH);
    digitalWrite(RED_LED, LOW);

    display.println("Posture: SLIGHT");
    display.println("Correct Slowly");

    digitalWrite(BUZZER, HIGH);
    delay(200);
    digitalWrite(BUZZER, LOW);
    delay(800);
  }
  else {

    digitalWrite(GREEN_LED, LOW);
    digitalWrite(YELLOW_LED, LOW);
    digitalWrite(RED_LED, HIGH);

    display.println("Posture: BAD");
    display.println("Straighten Back!");

    digitalWrite(BUZZER, HIGH);
    delay(100);
    digitalWrite(BUZZER, LOW);
    delay(200);
  }

  display.display();
  delay(200);
}

            </pre>
        </div>

        <a href="../index.html#projects" class="btn secondary">Back to Projects</a>

    </div>
</section>

</body>
</html>
